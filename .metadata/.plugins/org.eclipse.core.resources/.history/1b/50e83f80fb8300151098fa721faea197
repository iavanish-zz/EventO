package iavanish;

import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;

import com.mysql.jdbc.Connection;
import com.mysql.jdbc.Statement;

public class DatabaseRead {

	@SuppressWarnings("finally")
	public static Connection createConnection() {
    	
        Connection connection = null;
        
        try {
            Class.forName(Constants.dbClass);
            connection = (Connection)DriverManager.getConnection(Constants.dbURL, Constants.dbUser, Constants.dbPassword);
        }
        catch(Exception e) {
            e.printStackTrace();
        }
        finally {
            return connection;
        }
        
    }

    public static boolean checkLogin(String rollNo, String password) {
    	
        boolean isUserAvailable = false;
        Connection connection = null;
        
        try {
            
        	try {
                connection = createConnection();
            }
            catch(Exception e) {
            	e.printStackTrace();
            }
            
            Statement stmt = (Statement)connection.createStatement();
            
            String query = "SELECT * FROM user WHERE RollNo = '" + rollNo + "' AND Password =" + "'" + password + "'";

            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                isUserAvailable = true;
            }
            
        }
        
        catch(SQLException sqlE) {
            sqlE.printStackTrace();
        }
        catch(Exception e) {
            e.printStackTrace();
        }
        finally {
            if(connection != null) {
            	try {
            		connection.close();
            	}
            	catch(SQLException sqlE) {
            		sqlE.printStackTrace();
            	}
            	catch(Exception e) {
            		e.printStackTrace();
            	}
            }
        }
        
        return isUserAvailable;
        
    }    
	
}
